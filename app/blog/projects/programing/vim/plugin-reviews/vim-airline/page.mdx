import { generateMetadata } from '@/utils';
import { BasicVideo, Gif, CenteredImage, TwoCenteredImages, Checkmark, FromToCode } from '@/app/components/blog';

export const metadata = generateMetadata({
    title:"AirLine Review",
    description:"How are people getting a cool status line in Neovim? A complete review of the NeoVim plugin, lualine. This is part of my series of trying out and reviewing Vim and NeoVim plugins",
    keywords: ['Neovim', 'Neovim Plugins', 'lualine', 'review', 'Nash Bostwick']
}); 

import defaultLine from "@/public/vim-plugin-reviews/airline-nvim/airline-default.png";
import exampleLine from "@/public/vim-plugin-reviews/airline-nvim/airline-example.png";
import base16Line from "@/public/vim-plugin-reviews/airline-nvim/base16-example.png";
import rightSide from "@/public/vim-plugin-reviews/lualine-nvim/right-lua-line.JPEG";
import leftSide  from "@/public/vim-plugin-reviews/lualine-nvim/left-lua-line.PNG";
import bufferAdd  from "@/public/vim-plugin-reviews/lualine-nvim/buffer-added.png";
import addWords  from "@/public/vim-plugin-reviews/lualine-nvim/cust-comp-words.png";

import StatusLineComparison from '../components/status-line-comparison.mdx';

# Airline.nvim Review
Lean & mean status/tabline for vim that's light as air.

<BasicVideo>
    <iframe 
        width="560" 
        height="315"
        src="https://www.youtube.com/embed/3N2lB26FTPU?si=8k-ufvhqwOd1gcQo" 
        title="YouTube video player" 
        frameBorder="0" 
        allow="accelerometer; 
        autoplay; 
        clipboard-write; 
        encrypted-media; 
        gyroscope; 
        picture-in-picture; 
        web-share" 
        referrerPolicy="strict-origin-when-cross-origin" 
        allowFullScreen
    ></iframe>
</BasicVideo>

## What Does This Plugin Do?
Basically, this plugin is just a theme for your status line, but it also goes a little further than that. You can also show all kinds of information on it. There are tons of themes. You can check them out here -> [Airline Themes](https://github.com/vim-airline/vim-airline/wiki/Screenshots  "Airline Themes"). I am going to start by using the default theme and here is what my line looks like.

<CenteredImage image={exampleLine} altText={'Status Line example'} width={'w-2/3'} height={'h-3/4'}/>

## Instillation
For more context, You can see how I setup my Neovim Files here: [Wired's Neovim File Structure][999]

The readme offers options for many plugin managers:
| Plugin Manager | Install with... |
| ------------- | ------------- |
| [Pathogen][11] | `git clone https://github.com/vim-airline/vim-airline ~/.vim/bundle/vim-airline`<br/>Remember to run `:Helptags` to generate help tags |
| [NeoBundle][12] | `NeoBundle 'vim-airline/vim-airline'` |
| [Vundle][13] | `Plugin 'vim-airline/vim-airline'` |
| [Plug][40] | `Plug 'vim-airline/vim-airline'` |
| [VAM][22] | `call vam#ActivateAddons([ 'vim-airline' ])` |
| [Dein][52] | `call dein#add('vim-airline/vim-airline')` |
| [minpac][55] | `call minpac#add('vim-airline/vim-airline')` |
| pack feature (native Vim 8 package feature)| `git clone https://github.com/vim-airline/vim-airline ~/.vim/pack/dist/start/vim-airline`<br/>Remember to run `:helptags ~/.vim/pack/dist/start/vim-airline/doc` to generate help tags |
| manual | copy all of the files into your `~/.vim` directory |

I use vim-plug so I'll add this to my plugins file:
```lua
Plug 'vim-airline/vim-airline'
```

No need to add additional configuration. This plugin will work of of the box and look like:
<CenteredImage image={defaultLine} altText={'Airline default'} width={'w-2/3'} height={'h-3/4'}/>

A little ugly, but lets fix that! I want it to look like the example at the top of this article, so I am going to change the theme to base16. In order to do that we need to install the theme plugin
```lua
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'
```
To set the theme, and if you are using my folder structure, you will go to .vim/vimrc and add this line:
```vim
let g:airline_theme='base16'
```
No our line looks like:
<CenteredImage image={base16Line} altText={'Airline Base16 Theme'} width={'w-2/3'} height={'h-3/4'}/>
This is good, but it doesnt really look like the example, lets change the dividers. To do that, I am going to try a million things and non of them will work. I am thinking that this would work better with vim, but this is a Neovim plugin review. I wouldn't say it's impossible to change the dividers, but it will take some work that is out of scope of the review.

## Components
Components are an easy way to add functionality to Lualine. Here are the avalable components: 

```lua
branch (git branch)
buffers (shows currently available buffers)
diagnostics (diagnostics count from your preferred source)
diff (git diff status)
encoding (file encoding)
fileformat (file format)
filename
filesize
filetype
hostname
location (location in file in line:column format)
mode (vim mode)
progress (%progress in file)
searchcount (number of search matches when hlsearch is active)
selectioncount (number of selected characters or lines)
tabs (shows currently available tabs)
windows (shows currently available windows)
```
lets add a components, I need to be able to see the open buffers, so lets add the buffers component. We will need to go to the plugin config file and make some changes in the sections object. Lualine supports 3 components on the left side of the screen and 3 components on the right side of the screen. We are going to replace the lualine_c pramiter in the sections object with the buffers component.

<FromToCode
    from={`
      sections = {
          lualine_a = {'mode'},
          lualine_b = {'branch', 'diff', 'diagnostics'},
        - lualine_c = {'filename'},
          lualine_x = {'encoding', 'fileformat', 'filetype'},
          lualine_y = {'progress'},
          lualine_z = {'location'}
      },
    `}
    to={`
      sections = {
          lualine_a = {'mode'},
          lualine_b = {'branch', 'diff', 'diagnostics'},
        + lualine_c = {'buffer'},
          lualine_x = {'encoding', 'fileformat', 'filetype'},
          lualine_y = {'progress'},
          lualine_z = {'location'}
      }
    `}
/>

<CenteredImage image={bufferAdd} altText={'Lua Line'} width={'w-fit'} height={'h-full'}/>

Components are easy to add and from the above example it should be easy to configure the line as needed, but what if you need more? What if you want a custom component?

## Lets Add Functionality (Custom Component)
I want to implement a simple word counter that I can use while writing blog posts. I want it to display how many words are on the page, and also weather I am over, under, or in a predesignated range. For instance, I want to know how may words are in my blog post(so only mdx files), and I want my blog posts to be between 500 and 750 words. Seems simple enough, lets try it out.

1. Lets start by getting the word count:
I am just going to make this in the Lualine setup file. If I end up writing lots of these I can always move them later. Also, Keep in mind that this must be defined before it is used in the setup function.
```lua
local function getWords()
  return tostring(vim.fn.wordcount().words)
end


require('lualine').setup {}
```
If the source file is reloaded using :so or Neovim is closed are reopened you should see the word count on the far right hand corner of the line.
<CenteredImage image={addWords} altText={'Custom Lualine Component with word cound'} width={'w-fit'} height={'h-full'}/>

2. Making the Component Dynamic
We need to make a component that will choose the words or location based on the file type. Note that you cant just pass 'location' into the combine_component function. You have to actually define the function somewhere.
```lua
local function location()
  local line = vim.fn.line('.')
  local col = vim.fn.virtcol('.')
  return string.format('%3d:%-2d', line, col)
end

local function combined_component()
    local filetype = vim.bo.filetype
    if filetype == 'markdown' or filetype == 'mdx' then
        return getWords()
    else
        return location()
    end
end
```

3. Adding Dynamic Colors
We need to add a function that picks the color. Notice that if the file is not markdown or mdx it will return nil which will be the default color for the location component.

```lua
local function color()
    local filetype = vim.bo.filetype
    local word_count = vim.fn.wordcount().words
    if filetype == 'markdown' or filetype == 'mdx' then
        if word_count < 500 then return {bg = '#7d7cc0', fg= '#0A0A0A', gui='none'} end
        if word_count > 499 and word_count < 750 then return {bg = '#8EC07C', fg= '#0A0A0A', gui='none'} end
        if word_count > 750 then return {bg = '#c07c83', fg= '#0A0A0A', gui='none'} end
    else
        return nil
    end
end

```

4. Add The Component
Now we can add the combine_component to our lua config
```lua
sections = {
    lualine_a = {'mode'},
    lualine_b = {'branch', 'diff', 'diagnostics'},
    lualine_c = {'buffers'},
    lualine_x = {'encoding', 'fileformat', 'filetype'},
    lualine_y = {'progress'},
    lualine_z = {
        {
            combined_component,
            color = color,
        }
    }
}
```

## Completed Component
<div className='h-44 overflow-hidden'>
    <div className='-translate-y-44'>
        <Gif 
        video={"/vim-plugin-reviews/lualine-nvim/custom-component.mp4"}
        />

    </div>
</div>


## Limitations and Alternatives
<StatusLineComparison/>

## Can I edit my vimrc / init.lua Instead of Using This Plugin?
Yes you can and its not that hard!\
Vim script -> [Build a Custom Vim Status Line](/blog/projects/programing/vim/build-a-vim-status-line  "Build a Custom Vim Status Line")\
Lua -> [Build a Custom Neovim Status Line](/blog/projects/programing/vim/build-a-vim-status-line  "Build a Custom Neovim Status Line")

Link to the project -> [Lualine.nvim](https://github.com/nvim-lualine/lualine.nvim  "Lualine.nvim")\
Regardless of what I think about the plugin, I want to say thank you to everyone that is contributing to Neovim! Nothing is meant to be negative, my opinions are just that, opinions!

[999]: /blog/projects/programing/vim/setup


[1]: https://github.com/Lokaltog/vim-powerline
[2]: https://github.com/powerline/powerline
[3]: https://github.com/Lokaltog/powerline-fonts
[4]: https://github.com/tpope/vim-fugitive
[5]: https://github.com/scrooloose/syntastic
[6]: https://github.com/bling/vim-bufferline
[7]: https://github.com/bling/minivimrc
[8]: http://en.wikipedia.org/wiki/Open/closed_principle
[9]: https://github.com/Shougo/unite.vim
[10]: https://github.com/ctrlpvim/ctrlp.vim
[11]: https://github.com/tpope/vim-pathogen
[12]: https://github.com/Shougo/neobundle.vim
[13]: https://github.com/VundleVim/Vundle.vim
[14]: https://github.com/vim-airline/vim-airline/wiki/Screenshots
[15]: https://github.com/techlivezheng/vim-plugin-minibufexpl
[16]: https://github.com/sjl/gundo.vim
[17]: https://github.com/mbbill/undotree
[18]: https://github.com/preservim/nerdtree
[19]: https://github.com/majutsushi/tagbar
[20]: https://powerline.readthedocs.org/en/master/installation.html#patched-fonts
[21]: https://github.com/ludovicchabant/vim-lawrencium
[22]: https://github.com/MarcWeber/vim-addon-manager
[23]: https://github.com/altercation/solarized
[24]: https://github.com/chriskempson/tomorrow-theme
[25]: https://github.com/tomasr/molokai
[26]: https://github.com/nanotech/jellybeans.vim
[27]: https://github.com/vim-airline/vim-airline/wiki/FAQ
[28]: https://github.com/chrisbra/csv.vim
[29]: https://github.com/airblade/vim-gitgutter
[30]: https://github.com/mhinz/vim-signify
[31]: https://github.com/jmcantrell/vim-virtualenv
[32]: https://github.com/chriskempson/base16-vim
[33]: https://github.com/vim-airline/vim-airline/wiki/Test-Plan
[34]: http://eclim.org
[35]: https://github.com/edkolev/tmuxline.vim
[36]: https://github.com/edkolev/promptline.vim
[37]: https://github.com/gcmt/taboo.vim
[38]: https://github.com/vim-ctrlspace/vim-ctrlspace
[39]: https://github.com/tomtom/quickfixsigns_vim
[40]: https://github.com/junegunn/vim-plug
[41]: https://github.com/bling
[42]: https://github.com/chrisbra
[43]: https://github.com/vim-airline/vim-airline/wiki/Becoming-a-Maintainer
[45]: https://github.com/vim-airline/vim-airline/commit/d7fd8ca649e441b3865551a325b10504cdf0711b
[46]: https://github.com/vim-airline/vim-airline-themes#vim-airline-themes--
[47]: https://github.com/mildred/vim-bufmru
[48]: https://github.com/ierton/xkb-switch
[49]: https://github.com/vovkasm/input-source-switcher
[50]: https://github.com/jreybert/vimagit
[51]: https://github.com/Shougo/denite.nvim
[52]: https://github.com/Shougo/dein.vim
[53]: https://github.com/lervag/vimtex
[54]: https://github.com/mox-mox/vim-localsearch
[55]: https://github.com/k-takata/minpac/
[56]: https://github.com/vim-airline/vim-airline-themes/blob/master/autoload/airline/themes/dark_minimal.vim
[57]: https://github.com/autozimu/LanguageClient-neovim
[58]: https://github.com/vim-airline/vim-airline/blob/master/LICENSE
[59]: https://github.com/neoclide/coc-git
[60]: https://github.com/cdelledonne/vim-cmake
[61]: http://github.com/lambdalisue/battery.vim/
[62]: http://github.com/rbong/vim-flog/
[63]: https://github.com/lewis6991/gitsigns.nvim
[64]: https://github.com/VimfanTPdvorak/vimodoro
